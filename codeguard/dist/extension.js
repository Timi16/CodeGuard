(()=>{"use strict";var e={35:function(e,t,n){var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,o)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return o(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.analyzeAdvancedSQLInjection=async function(e){const t=[],n=[/SELECT\s+.*\s+FROM\s+.*\s+WHERE\s+.*=.*\s+('|").*\1\s*;/gi,/INSERT\s+INTO\s+.*\s+VALUES\s+\(.*\)\s*;/gi,/UPDATE\s+.*\s+SET\s+.*=.*\s+('|").*\1\s*WHERE\s+.*=.*\s*;/gi,/DELETE\s+FROM\s+.*\s+WHERE\s+.*=.*\s+('|").*\1\s*;/gi],i=(await(0,s.getFileContents)(e)).split("\n");for(let e=0;e<i.length;e++){const o=i[e];for(const i of n){let n;for(;null!==(n=i.exec(o));){const i=new r.Diagnostic(new r.Range(e,n.index,e,n.index+n[0].length),`Potential SQL injection vulnerability: ${n[0]}`,r.DiagnosticSeverity.Warning);t.push(i)}}if(/\${.*?}/.test(o)){const n=new r.Diagnostic(new r.Range(e,0,e,o.length),`Potentially unsafe dynamic SQL query detected: ${o.trim()}`,r.DiagnosticSeverity.Warning);t.push(n)}}r.languages.createDiagnosticCollection("advancedSQLInjectionAnalyzer").set(e,t),t.length>0?r.window.showInformationMessage(`Advanced SQL Injection analysis completed with ${t.length} issues found.`):r.window.showInformationMessage("No advanced SQL Injection vulnerabilities found.")};const r=a(n(398)),s=n(509)},772:function(e,t,n){var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,o)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return o(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.analyzeSecrets=async function(e){const t=[],n=(await(0,s.getFileContents)(e)).split("\n"),i=await(0,s.getSecretPatterns)();for(let e=0;e<n.length;e++){const o=n[e];for(const n of i){let i;for(;null!==(i=n.pattern.exec(o));){const n=new r.Diagnostic(new r.Range(e,i.index,e,i.index+i[0].length),`Misplaced secret detected: ${i[0]}`,r.DiagnosticSeverity.Warning);t.push(n)}}}r.languages.createDiagnosticCollection("secretAnalyzer").set(e,t),t.length>0?r.window.showInformationMessage(`Secret analysis completed with ${t.length} issues found.`):r.window.showInformationMessage("No misplaced secrets found.")};const r=a(n(398)),s=n(509)},280:function(e,t,n){var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,o)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return o(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.analyzeAdvancedXSS=async function(e){const t=[],n=[{context:"HTML",pattern:/<script[\s\S]*?>[\s\S]*?<\/script>/gi},{context:"HTML",pattern:/<[^>]+on\w+\s*=\s*['"].*['"]/gi},{context:"JavaScript",pattern:/document\.write\(/gi},{context:"JavaScript",pattern:/eval\(/gi},{context:"JavaScript",pattern:/innerHTML\s*=\s*['"].*['"]/gi},{context:"URL",pattern:/href\s*=\s*['"]javascript:.*['"]/gi}],i=(await(0,s.getFileContents)(e)).split("\n");for(let e=0;e<i.length;e++){const o=i[e];for(const{context:i,pattern:a}of n){let n;for(;null!==(n=a.exec(o));){const o=new r.Diagnostic(new r.Range(e,n.index,e,n.index+n[0].length),`Potential XSS vulnerability in ${i} context: ${n[0]}`,r.DiagnosticSeverity.Warning);t.push(o)}}if(/(\${.*?})|(\+\s*['"].*['"])/.test(o)){const n=new r.Diagnostic(new r.Range(e,0,e,o.length),`Potential unsafe user input usage detected: ${o.trim()}`,r.DiagnosticSeverity.Warning);t.push(n)}}r.languages.createDiagnosticCollection("advancedXSSAnalyzer").set(e,t),t.length>0?r.window.showInformationMessage(`Advanced XSS analysis completed with ${t.length} issues found.`):r.window.showInformationMessage("No advanced XSS vulnerabilities found.")};const r=a(n(398)),s=n(509)},265:function(e,t,n){var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,o)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return o(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.activate=function(e){console.log('Congratulations, your extension "codeguard" is now active!');const t=r.commands.registerCommand("codeguard.analyzeSecrets",(async()=>{const e=r.window.activeTextEditor;if(e)try{await(0,s.analyzeSecrets)(e.document.uri)}catch(e){r.window.showErrorMessage("Failed to analyze secrets: "+e.message)}else r.window.showInformationMessage("No active editor detected.")})),n=r.commands.registerCommand("codeguard.analyzeAdvancedXSS",(async()=>{const e=r.window.activeTextEditor;if(e)try{await(0,c.analyzeAdvancedXSS)(e.document.uri)}catch(e){r.window.showErrorMessage("Failed to analyze XSS: "+e.message)}else r.window.showInformationMessage("No active editor detected.")})),i=r.commands.registerCommand("codeguard.analyzeAdvancedSQLInjection",(async()=>{const e=r.window.activeTextEditor;if(e)try{await(0,u.analyzeAdvancedSQLInjection)(e.document.uri)}catch(e){r.window.showErrorMessage("Failed to analyze SQL Injection: "+e.message)}else r.window.showInformationMessage("No active editor detected.")}));e.subscriptions.push(t),e.subscriptions.push(n),e.subscriptions.push(i)},t.deactivate=function(){};const r=a(n(398)),s=n(772),c=n(280),u=n(35)},509:function(e,t,n){var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,o)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return o(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.getFileContents=async function(e){const t=e.fsPath;return new Promise(((e,n)=>{r.readFile(t,"utf8",((t,i)=>{t?n(t):e(i)}))}))},t.getSecretPatterns=async function(){return[{name:"API Key",pattern:/API_KEY\s*=\s*['"].+['"]/g},{name:"Secret Key",pattern:/SECRET_KEY\s*=\s*['"].+['"]/g},{name:"Password",pattern:/password\s*=\s*['"].+['"]/g},{name:"Token",pattern:/token\s*=\s*['"].+['"]/g}]};const r=a(n(896))},398:e=>{e.exports=require("vscode")},896:e=>{e.exports=require("fs")}},t={},n=function n(i){var o=t[i];if(void 0!==o)return o.exports;var a=t[i]={exports:{}};return e[i].call(a.exports,a,a.exports,n),a.exports}(265);module.exports=n})();