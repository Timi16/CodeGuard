(()=>{"use strict";var e={772:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return o(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.analyzeSecrets=async function(e){const t=[],n=(await(0,s.getFileContents)(e)).split("\n"),r=await(0,s.getSecretPatterns)();for(let e=0;e<n.length;e++){const o=n[e];for(const n of r){let r;for(;null!==(r=n.pattern.exec(o));){const n=new a.Diagnostic(new a.Range(e,r.index,e,r.index+r[0].length),`Misplaced secret detected: ${r[0]}`,a.DiagnosticSeverity.Warning);t.push(n)}}}a.languages.createDiagnosticCollection("secretAnalyzer").set(e,t),t.length>0?a.window.showInformationMessage(`Secret analysis completed with ${t.length} issues found.`):a.window.showInformationMessage("No misplaced secrets found.")};const a=i(n(398)),s=n(509)},265:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return o(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.activate=function(e){console.log('Congratulations, your extension "codeguard" is now active!');const t=a.commands.registerCommand("codeguard.analyzeSecrets",(async()=>{const e=a.window.activeTextEditor;if(e)try{await(0,s.analyzeSecrets)(e.document.uri)}catch(e){a.window.showErrorMessage("Failed to analyze secrets: "+e.message)}else a.window.showInformationMessage("No active editor detected.")})),n=a.commands.registerCommand("codeguard.helloWorld",(()=>{a.window.showInformationMessage("Hello World from CodeGuard!")}));e.subscriptions.push(t),e.subscriptions.push(n)},t.deactivate=function(){};const a=i(n(398)),s=n(772)},509:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return o(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.getFileContents=async function(e){const t=e.fsPath;return new Promise(((e,n)=>{a.readFile(t,"utf8",((t,r)=>{t?n(t):e(r)}))}))},t.getSecretPatterns=async function(){return[{name:"API Key",pattern:/API_KEY\s*=\s*['"].+['"]/g},{name:"Secret Key",pattern:/SECRET_KEY\s*=\s*['"].+['"]/g},{name:"Password",pattern:/password\s*=\s*['"].+['"]/g},{name:"Token",pattern:/token\s*=\s*['"].+['"]/g}]};const a=i(n(896))},398:e=>{e.exports=require("vscode")},896:e=>{e.exports=require("fs")}},t={},n=function n(r){var o=t[r];if(void 0!==o)return o.exports;var i=t[r]={exports:{}};return e[r].call(i.exports,i,i.exports,n),i.exports}(265);module.exports=n})();